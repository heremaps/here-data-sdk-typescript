os: linux
dist: bionic
language: node_js
node_js:
  - lts/*
cache: yarn
env:
  global:
  - WORKSPACE=$TRAVIS_BUILD_DIR
addons:
  apt:
    packages:
    - libgconf-2-4
branches:
    only:
      - master
script: $WORKSPACE/scripts/linux/psv/travis_build_test_psv.sh && echo "Event $TRAVIS_EVENT_TYPE, Message $TRAVIS_COMMIT_MESSAGE"
name: "PSV Linux Build & Test"

deploy:
  - provider: script
    script: $WORKSPACE/scripts/publish-packages.sh && echo "Event $TRAVIS_EVENT_TYPE, Message $TRAVIS_COMMIT_MESSAGE"
    cleanup: false
    on:
       branch: master
       condition: [ $TRAVIS_EVENT_TYPE = api && $TRAVIS_COMMIT_MESSAGE = 'Publish to NPM' ]